# =============================================================================
# TRACK RECORD ENCLAVE - ENVIRONMENT CONFIGURATION
# =============================================================================
#
# ⚠️  FOR AUDITORS / LOCAL TESTING ONLY
#
# This file allows you to run the enclave locally for code review and testing.
# Copy to .env and configure values below.
#
# In production, AuditZK uses Google Cloud Secret Manager - no .env file is
# deployed. Secrets (JWT_SECRET, DATABASE_URL, etc.) are injected at runtime
# via --set-secrets in Cloud Run.
#
# =============================================================================

# -----------------------------------------------------------------------------
# ENCLAVE CONFIGURATION
# -----------------------------------------------------------------------------
# Enable enclave mode (set to true in production AMD SEV-SNP VM)
ENCLAVE_MODE=true

# AMD SEV-SNP attestation (set to true only on SEV-SNP capable hardware)
AMD_SEV_SNP=false

# gRPC server port (internal network only, NOT exposed to internet)
ENCLAVE_PORT=50051

# -----------------------------------------------------------------------------
# DATABASE (Neon PostgreSQL - Cloud)
# -----------------------------------------------------------------------------
# Neon PostgreSQL connection string
# All data (snapshots, encrypted credentials, DEKs) stored in Neon
DATABASE_URL="postgresql://neondb_owner:YOUR_PASSWORD@ep-xxx.neon.tech/neondb?sslmode=require"

# -----------------------------------------------------------------------------
# SECURITY
# -----------------------------------------------------------------------------
# JWT Secret for authentication tokens
# For local testing, any 32+ char string works
# Generate: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
JWT_SECRET="local-testing-secret-replace-with-random-value"

# -----------------------------------------------------------------------------
# LOGGING
# -----------------------------------------------------------------------------
# Log level (error, warn, info, debug)
LOG_LEVEL="info"

# Enable detailed query logging (true/false)
QUERY_LOGGING="false"

# API key for HTTP log server access (SOC 2 requirement)
# Required to access /logs, /logs/stream, /logs/clear endpoints
# Generate: node -e "console.log(require('crypto').randomBytes(24).toString('hex'))"
LOG_SERVER_API_KEY=""

# -----------------------------------------------------------------------------
# MONITORING & METRICS
# -----------------------------------------------------------------------------
# Enable Prometheus metrics endpoint (true/false)
METRICS_ENABLED="true"

# Prometheus metrics server port (internal network only)
METRICS_PORT="9090"

# Metrics path (default is /metrics)
METRICS_PATH="/metrics"

# Health check settings
HEALTH_CHECK_TIMEOUT_MS="5000"
HEALTH_CHECK_DATABASE="true"

# -----------------------------------------------------------------------------
# EXCHANGE API CREDENTIALS (Optional - for development)
# -----------------------------------------------------------------------------
# These are typically stored encrypted in the database
# Only set these for local development testing

# Interactive Brokers OAuth
# IBKR_CLIENT_ID="your_ibkr_client_id"
# IBKR_CLIENT_SECRET="your_ibkr_client_secret"
# IBKR_REDIRECT_URI="http://localhost:3010/api/exchanges/ibkr/callback"

# -----------------------------------------------------------------------------
# ATTESTATION (Production Only)
# -----------------------------------------------------------------------------
# SEV-SNP attestation report endpoint
# ATTESTATION_ENDPOINT="http://169.254.169.254/metadata/instance/compute/attestation"

# TLS certificates for gRPC (mutual TLS in production)
# TLS_CA_CERT="/etc/enclave/ca.crt"
# TLS_SERVER_CERT="/etc/enclave/server.crt"
# TLS_SERVER_KEY="/etc/enclave/server.key"

# -----------------------------------------------------------------------------
# DEVELOPMENT ONLY
# -----------------------------------------------------------------------------
# Enable debug mode
# DEBUG="true"

# Node environment
NODE_ENV="development"